sage: A
Quaternion Algebra (-70369817919488, -79247275156441366542604096765952) with base ring Rational Field
sage: B
Quaternion Algebra (-3, -65537) with base ring Rational Field
sage: A.ramified_places()
([65537],
 [Ring morphism:
    From: Rational Field
    To:   Real Field with 53 bits of precision
    Defn: 1 |--> 1.00000000000000])
sage: B.ramified_places()
([65537],
 [Ring morphism:
    From: Rational Field
    To:   Real Field with 53 bits of precision
    Defn: 1 |--> 1.00000000000000])
sage: ### Compute a maximal order in A tensor B op ###
sage: %time test_15(-70369817919488,-79247275156441366542604096765952,-3,-65537)
================================================================================
STARTING test_max_order_tensor_quat_alg
================================================================================

Input A: Quaternion Algebra (-70369817919488, -79247275156441366542604096765952) with base ring Rational Field
Input B: Quaternion Algebra (-3, -65537) with base ring Rational Field
Input Zbasis_O1: None
Input Zbasis_O2: None


Creating tensor product C = tensor(A, opposite(B))...
C = Finite-dimensional algebra of degree 16 over Rational Field


Getting basis of C...
BC = Finite family {0: e0,  1: e1,  2: e2,  3: e3,  4: e4,  5: e5,  6: e6,  7: e7,  8: e8,  9: e9,  10: e10,  11: e11,  12: e12,  13: e13,  14: e14,  15: e15}
Length of BC: 16


================================================================================
Zbasis_O1 is None, computing a maximal order in A...
================================================================================

Computed Zbasis_O1: [347/1419300964915925942272*j + 8196306311/3047972121401591020869388337152*k, -9/144147754249273728512*j + 62384357046065/39623637578220683271302048382976*k, 1/65536*i + 3359/36901825087814074499072*j + 15622727257027/19811818789110341635651024191488*k, 1/2 + 9/288295508498547457024*j - 62384357046065/79247275156441366542604096765952*k]


================================================================================
Zbasis_O2 is None, computing a maximal order in B...
================================================================================
Computed Zbasis_O2: [-1/3*i + 1/3*k, -1/2 + 1/3*i + 1/6*k, 1/6*i - 1/2*j + 1/3*k, -1/6*i - 1/2*j - 1/3*k]


Zbasis_O1 has 4 elements
Zbasis_O2 has 4 elements
Expected tensor basis size: 4 × 4 = 16


================================================================================
Building a Z basis of O = O1⊗O2 in C
================================================================================

Zbasis_O = 
[-347/4257902894747777826816*e9 + 347/4257902894747777826816*e11 - 8196306311/9143916364204773062608165011456*e13 + 8196306311/9143916364204773062608165011456*e15, -347/2838601929831851884544*e8 + 347/4257902894747777826816*e9 + 347/8515805789495555653632*e11 - 8196306311/6095944242803182041738776674304*e12 + 8196306311/9143916364204773062608165011456*e13 + 8196306311/18287832728409546125216330022912*e15, 347/8515805789495555653632*e9 - 347/2838601929831851884544*e10 + 347/4257902894747777826816*e11 + 8196306311/18287832728409546125216330022912*e13 - 8196306311/6095944242803182041738776674304*e14 + 8196306311/9143916364204773062608165011456*e15, -347/8515805789495555653632*e9 - 347/2838601929831851884544*e10 - 347/4257902894747777826816*e11 - 8196306311/18287832728409546125216330022912*e13 - 8196306311/6095944242803182041738776674304*e14 - 8196306311/9143916364204773062608165011456*e15, 3/144147754249273728512*e9 - 3/144147754249273728512*e11 - 62384357046065/118870912734662049813906145148928*e13 + 62384357046065/118870912734662049813906145148928*e15, 9/288295508498547457024*e8 - 3/144147754249273728512*e9 - 3/288295508498547457024*e11 - 62384357046065/79247275156441366542604096765952*e12 + 62384357046065/118870912734662049813906145148928*e13 + 62384357046065/237741825469324099627812290297856*e15, -3/288295508498547457024*e9 + 9/288295508498547457024*e10 - 3/144147754249273728512*e11 + 62384357046065/237741825469324099627812290297856*e13 - 62384357046065/79247275156441366542604096765952*e14 + 62384357046065/118870912734662049813906145148928*e15, 3/288295508498547457024*e9 + 9/288295508498547457024*e10 + 3/144147754249273728512*e11 - 62384357046065/237741825469324099627812290297856*e13 - 62384357046065/79247275156441366542604096765952*e14 - 62384357046065/118870912734662049813906145148928*e15, -1/196608*e5 + 1/196608*e7 - 3359/110705475263442223497216*e9 + 3359/110705475263442223497216*e11 - 15622727257027/59435456367331024906953072574464*e13 + 15622727257027/59435456367331024906953072574464*e15, -1/131072*e4 + 1/196608*e5 + 1/393216*e7 - 3359/73803650175628148998144*e8 + 3359/110705475263442223497216*e9 + 3359/221410950526884446994432*e11 - 15622727257027/39623637578220683271302048382976*e12 + 15622727257027/59435456367331024906953072574464*e13 + 15622727257027/118870912734662049813906145148928*e15, 1/393216*e5 - 1/131072*e6 + 1/196608*e7 + 3359/221410950526884446994432*e9 - 3359/73803650175628148998144*e10 + 3359/110705475263442223497216*e11 + 15622727257027/118870912734662049813906145148928*e13 - 15622727257027/39623637578220683271302048382976*e14 + 15622727257027/59435456367331024906953072574464*e15, -1/393216*e5 - 1/131072*e6 - 1/196608*e7 - 3359/221410950526884446994432*e9 - 3359/73803650175628148998144*e10 - 3359/110705475263442223497216*e11 - 15622727257027/118870912734662049813906145148928*e13 - 15622727257027/39623637578220683271302048382976*e14 - 15622727257027/59435456367331024906953072574464*e15, -1/6*e1 + 1/6*e3 - 3/288295508498547457024*e9 + 3/288295508498547457024*e11 + 62384357046065/237741825469324099627812290297856*e13 - 62384357046065/237741825469324099627812290297856*e15, -1/4*e0 + 1/6*e1 + 1/12*e3 - 9/576591016997094914048*e8 + 3/288295508498547457024*e9 + 3/576591016997094914048*e11 + 62384357046065/158494550312882733085208193531904*e12 - 62384357046065/237741825469324099627812290297856*e13 - 62384357046065/475483650938648199255624580595712*e15, 1/12*e1 - 1/4*e2 + 1/6*e3 + 3/576591016997094914048*e9 - 9/576591016997094914048*e10 + 3/288295508498547457024*e11 - 62384357046065/475483650938648199255624580595712*e13 + 62384357046065/158494550312882733085208193531904*e14 - 62384357046065/237741825469324099627812290297856*e15, -1/12*e1 - 1/4*e2 - 1/6*e3 - 3/576591016997094914048*e9 - 9/576591016997094914048*e10 - 3/288295508498547457024*e11 + 62384357046065/475483650938648199255624580595712*e13 + 62384357046065/158494550312882733085208193531904*e14 + 62384357046065/237741825469324099627812290297856*e15]

================================================================================
Discriminant Check :
================================================================================
discriminant(A, O1) = -4295098369
discriminant(B, O2) = -4295098369
discriminant(C, O) = 115820362025776631693689603365018915167340735378361777628776982500522972938241
Expected discriminant relation: dO = dO1**4* dO2**4 = 115820362025776631693689603365018915167340735378361777628776982500522972938241
Discriminant check: True


================================================================================
Computing maximal order L containing O...
================================================================================
 --- Start computing a maximal over order --- 

starting discriminant  : 115820362025776631693689603365018915167340735378361777628776982500522972938241 = 65537^16

We use the iterrative algorithm.

[INFO] discriminant : 65537^16
[INFO] list of primes divisor of the discriminant : [65537]
[TIMING] Compute discriminant : 0.0514 s
[Timing] Factor the discriminant : 0.0008s
[Info] Working at prime p = 65537
[Timing] Finite algebra and projection computed in 0.1472 s
[Timing] Radical and quotient A/Rad(A) computed in 0.1233 s
[Timing] Zero ideal kernel computed in 0.0250 s
[Timing] Left order computed in 0.3449 s
[Result] Found strictly bigger order at prime 65537 (zero ideal case).
[Total Time] 0.6453 s

[INFO] discriminant : 65537^8
[INFO] list of primes divisor of the discriminant : [65537]
[TIMING] Compute discriminant : 0.0489 s
[Timing] Factor the discriminant : 0.0003s
[Info] Working at prime p = 65537
[Timing] Finite algebra and projection computed in 0.1315 s
[Timing] Radical and quotient A/Rad(A) computed in 0.1011 s
[Timing] Zero ideal kernel computed in 0.0245 s
[Timing] Left order computed in 0.3062 s
[Timing] Minimal ideals list at p=65537 computed in 0.0683 s
[INFO] Number of minimal ideals : 2
[Timing] Quotient by ideal computed in 0.0090 s
[Timing] Zero ideal kernel computed in 0.0231 s
[Timing] Left order computed in 0.3123 s
[Result] Found strictly bigger order at prime 65537 (minimal ideal case).
[Total Time] 0.9859 s

[INFO] discriminant : 1
[INFO] list of primes divisor of the discriminant : []
[TIMING] Compute discriminant : 0.0525 s
[Timing] Factor the discriminant : 0.0002s

Zbasis_L = [-1081779/1209217455390035500222840832*e11 + 2521381463/9905909394555170817825512095744*e15, 1081779/1209217455390035500222840832*e10 - 2521381463/9905909394555170817825512095744*e14, -1095949/604608727695017750111420416*e11 - 239819906445/39623637578220683271302048382976*e15, -1095949/604608727695017750111420416*e10 - 239819906445/39623637578220683271302048382976*e14, -347/8515805789495555653632*e9 + 1110119/2418434910780071000445681664*e10 + 3273677/3627652366170106500668522496*e11 - 8196306311/18287832728409546125216330022912*e13 + 249905432297/79247275156441366542604096765952*e14 + 229734380593/118870912734662049813906145148928*e15, -347/2838601929831851884544*e8 + 1110119/2418434910780071000445681664*e11 - 8196306311/6095944242803182041738776674304*e12 + 249905432297/79247275156441366542604096765952*e15, 3/288295508498547457024*e9 + 1095949/1209217455390035500222840832*e10 + 360593/1209217455390035500222840832*e11 - 62384357046065/237741825469324099627812290297856*e13 + 239819906445/79247275156441366542604096765952*e14 - 2521381463/29717728183665512453476536287232*e15, -9/288295508498547457024*e8 - 1095949/1209217455390035500222840832*e11 + 62384357046065/79247275156441366542604096765952*e12 - 239819906445/79247275156441366542604096765952*e15, 1/12885098496*e5 - 1/12885098496*e7 - 463511/151152181923754437527855104*e8 - 1081779/2418434910780071000445681664*e10 - 1110119/2418434910780071000445681664*e11 - 28298672334833/79247275156441366542604096765952*e12 + 2521381463/19811818789110341635651024191488*e14 - 249905432297/79247275156441366542604096765952*e15, 1/25770196992*e5 + 1/8590065664*e6 + 1/12885098496*e7 - 5182175/302304363847508875055710208*e8 + 3359/221410950526884446994432*e9 + 1081779/4836869821560142000891363328*e10 + 5465575/7255304732340213001337044992*e11 + 532588823613/2476477348638792704456378023936*e12 + 15622727257027/118870912734662049813906145148928*e13 - 2521381463/39623637578220683271302048382976*e14 + 234777143519/118870912734662049813906145148928*e15, -1/8590065664*e4 + 1/12885098496*e5 + 1/25770196992*e7 + 205306431/4836869821560142000891363328*e8 - 2036399/302304363847508875055710208*e9 - 1110119/2418434910780071000445681664*e10 - 6186761/4836869821560142000891363328*e11 + 2946782179221/79247275156441366542604096765952*e12 - 11255829979217/237741825469324099627812290297856*e13 - 249905432297/79247275156441366542604096765952*e14 - 694245904705/237741825469324099627812290297856*e15, 1/8590065664*e4 + 1/12885098496*e5 + 1/25770196992*e7 + 205306431/4836869821560142000891363328*e8 + 2036399/302304363847508875055710208*e9 - 1110119/2418434910780071000445681664*e10 - 2580831/4836869821560142000891363328*e11 + 2946782179221/79247275156441366542604096765952*e12 + 11255829979217/237741825469324099627812290297856*e13 - 249905432297/79247275156441366542604096765952*e14 - 744673533965/237741825469324099627812290297856*e15, 1/131074*e2 + 1095949/1209217455390035500222840832*e10 - 16125/75576090961877218763927552*e11 + 239819906445/79247275156441366542604096765952*e14 + 560180589630069/649203583990962229887830586218774528*e15, -1/131074*e3 + 307779/1209217455390035500222840832*e10 + 1095949/1209217455390035500222840832*e11 + 189412248993697/81150447998870278735978823277346816*e14 + 239819906445/79247275156441366542604096765952*e15, -1/12*e1 - 1/262148*e2 + 1/393222*e3 - 3/576591016997094914048*e9 + 265085/1209217455390035500222840832*e10 + 38751/93016727337695038478680064*e11 + 62384357046065/475483650938648199255624580595712*e13 + 8076137990129909/10387257343855395678205289379500392448*e14 + 3313304998580551/1198529693521776424408302620711583744*e15, -1/4*e0 - 1/262148*e3 - 9/576591016997094914048*e8 + 694779/1209217455390035500222840832*e10 + 545/93016727337695038478680064*e11 + 62384357046065/158494550312882733085208193531904*e12 + 1350054215008945/1298407167981924459775661172437549056*e14 + 19999304473/12191888485606364083477553348608*e15]
Zbasis_L has 16 elements

================================================================================
Final discriminant check :
================================================================================

dGamma = 1 = 1

================================================================================
COMPLETED test_max_order_tensor_quat_alg
================================================================================
CPU times: user 3.86 s, sys: 78.8 ms, total: 3.94 s
Wall time: 4.19 s
sage: 